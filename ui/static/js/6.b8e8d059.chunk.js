(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[6],{635:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(169);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,s=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(l){r=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(r)throw s}}return n}}(e,t)||Object(a.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},687:function(e,t,n){e.exports=function(e,t){"use strict";function n(t){return e.createElement("button",{type:"button",className:t.classNames.selectedTag,title:t.removeButtonText,onClick:t.onDelete},e.createElement("span",{className:t.classNames.selectedTagName},t.tag.name))}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var a={position:"absolute",width:0,height:0,visibility:"hidden",overflow:"scroll",whiteSpace:"pre"},r=["fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform"],s=function(t){function n(n){t.call(this,n),this.state={inputWidth:null},this.input=e.createRef(),this.sizer=e.createRef()}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.componentDidMount=function(){this.props.autoresize&&(this.copyInputStyles(),this.updateInputWidth())},n.prototype.componentDidUpdate=function(e){var t=e.query,n=e.placeholder;t===this.props.query&&n===this.props.placeholder||this.updateInputWidth()},n.prototype.copyInputStyles=function(){var e=this,t=window.getComputedStyle(this.input.current);r.forEach((function(n){e.sizer.current.style[n]=t[n]}))},n.prototype.updateInputWidth=function(){var e;this.props.autoresize&&(e=Math.ceil(this.sizer.current.scrollWidth)+2),e!==this.state.inputWidth&&this.setState({inputWidth:e})},n.prototype.render=function(){var t=this.props,n=t.id,r=t.query,s=t.ariaLabelText,i=t.placeholderText,o=t.expanded,l=t.classNames,u=t.inputAttributes,c=t.inputEventHandlers,p=t.index;return e.createElement("div",{className:l.searchWrapper},e.createElement("input",Object.assign({},u,c,{ref:this.input,value:r,placeholder:i,className:l.searchInput,role:"combobox","aria-autocomplete":"list","aria-label":s||i,"aria-owns":n,"aria-activedescendant":p>-1?n+"-"+p:null,"aria-expanded":o,style:{width:this.state.inputWidth}})),e.createElement("div",{ref:this.sizer,style:a},r||i))},n}(e.Component);function i(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}function o(e,t){var n=new RegExp(i(t),"gi");return e.replace(n,"<mark>$&</mark>")}var l=function(t){var n=t.item,a=t.query;return e.createElement("span",{dangerouslySetInnerHTML:{__html:o(n.name,a)}})},u=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.onMouseDown=function(e,t){t.preventDefault(),this.props.addTag(e)},n.prototype.render=function(){var t=this;if(!this.props.expanded||!this.props.options.length)return null;var n=this.props.suggestionComponent||l,a=this.props.options.map((function(a,r){var s=t.props.id+"-"+r,i=[];return t.props.index===r&&i.push(t.props.classNames.suggestionActive),a.disabled&&i.push(t.props.classNames.suggestionDisabled),e.createElement("li",{id:s,key:s,role:"option",className:i.join(" "),"aria-disabled":!0===a.disabled,onMouseDown:t.onMouseDown.bind(t,a)},a.disableMarkIt?a.name:e.createElement(n,{item:a,query:t.props.query}))}));return e.createElement("div",{className:this.props.classNames.suggestions},e.createElement("ul",{role:"listbox",id:this.props.id},a))},n}(e.Component),c="Enter",p="Tab",d="Backspace",m="ArrowUp",h="Up",f="ArrowDown",g="Down";function v(){var e=this;if(this.state.query.length>=this.props.minQueryLength){var t=this.state.options.findIndex((function(t){return(n=e.state.query,new RegExp("^"+i(n)+"$","i")).test(t.name);var n})),n=-1===this.state.index?t:this.state.index;n>-1&&this.state.options[n]?this.addTag(this.state.options[n]):this.props.allowNew&&this.addTag({name:this.state.query})}}function b(e){e.preventDefault();var t=this.state.options.length-1;this.setState({index:this.state.index<=0?t:this.state.index-1})}function y(e){e.preventDefault();var t=this.state.options.length-1;this.setState({index:this.state.index>=t?0:this.state.index+1})}function E(){this.state.query.length||this.deleteTag(this.props.tags.length-1)}function x(e,t){var n;return 0===(n=e.suggestionsTransform?e.suggestionsTransform(t.query,e.suggestions):e.suggestions.filter((function(n){return e.suggestionsFilter(n,t.query)}))).length&&e.noSuggestionsText&&n.push({id:0,name:e.noSuggestionsText,disabled:!0,disableMarkIt:!0}),n.slice(0,e.maxSuggestionsLength)}var w=function(t){function a(n){t.call(this,n),this.state={query:"",focused:!1,index:-1},this.inputEventHandlers={onChange:function(){},onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),onInput:this.onInput.bind(this),onKeyDown:this.onKeyDown.bind(this)},this.container=e.createRef(),this.input=e.createRef(),this.suggestions=e.createRef()}return t&&(a.__proto__=t),a.prototype=Object.create(t&&t.prototype),a.prototype.constructor=a,a.prototype.onInput=function(e){var t=e.target.value;this.props.onInput&&this.props.onInput(t),t.length===this.state.query.length+1&&this.props.delimiters.indexOf(t.slice(-1))>-1?v.call(this):t!==this.state.query&&this.setState({query:t})},a.prototype.onKeyDown=function(e){this.props.delimiters.indexOf(e.key)>-1&&((this.state.query||this.state.index>-1)&&e.preventDefault(),v.call(this)),e.key===d&&this.props.allowBackspace&&E.call(this,e),e.key!==m&&e.key!==h||b.call(this,e),e.key!==f&&e.key!==g||y.call(this,e)},a.prototype.onClick=function(e){document.activeElement!==e.target&&this.input.current.input.current.focus()},a.prototype.onBlur=function(){this.setState({focused:!1,index:-1}),this.props.onBlur&&this.props.onBlur(),this.props.addOnBlur&&v.call(this)},a.prototype.onFocus=function(){this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()},a.prototype.onDeleteTag=function(e,t){if(this.container.current){var n=this.container.current.querySelectorAll("a,button,input"),a=Array.prototype.findIndex.call(n,(function(e){return e===t.currentTarget})),r=n[a-1]||n[a+1];r&&r.focus()}this.deleteTag(e)},a.prototype.addTag=function(e){e.disabled||("function"!==typeof this.props.onValidate||this.props.onValidate(e))&&(this.props.onAddition(e),this.clearInput())},a.prototype.deleteTag=function(e){this.props.onDelete(e)},a.prototype.clearInput=function(){this.setState({query:"",index:-1})},a.prototype.render=function(){var t=this,a=this.props.tagComponent||n,r=this.state.focused&&this.state.query.length>=this.props.minQueryLength,i=[this.props.classNames.root];return this.state.focused&&i.push(this.props.classNames.rootFocused),e.createElement("div",{ref:this.container,className:i.join(" "),onClick:this.onClick.bind(this)},e.createElement("div",{className:this.props.classNames.selected,"aria-relevant":"additions removals","aria-live":"polite"},this.props.tags.map((function(n,r){return e.createElement(a,{key:r,tag:n,removeButtonText:t.props.removeButtonText,classNames:t.props.classNames,onDelete:t.onDeleteTag.bind(t,r)})}))),e.createElement("div",{className:this.props.classNames.search},e.createElement(s,Object.assign({},this.state,{id:this.props.id,ref:this.input,classNames:this.props.classNames,inputAttributes:this.props.inputAttributes,inputEventHandlers:this.inputEventHandlers,autoresize:this.props.autoresize,expanded:r,placeholderText:this.props.placeholderText,ariaLabelText:this.props.ariaLabelText})),e.createElement(u,Object.assign({},this.state,{id:this.props.id,ref:this.suggestions,classNames:this.props.classNames,expanded:r,addTag:this.addTag.bind(this),suggestionComponent:this.props.suggestionComponent}))))},a.getDerivedStateFromProps=function(e,t){return t.prevQuery!==t.query||t.prevSuggestions!==e.suggestions?{prevQuery:t.query,prevSuggestions:e.suggestions,options:x(e,t)}:null},a}(e.Component);return w.defaultProps={id:"ReactTags",tags:[],placeholderText:"Add new tag",removeButtonText:"Click to remove tag",noSuggestionsText:null,suggestions:[],suggestionsFilter:function(e,t){return(n=t,new RegExp("(?:^|\\s)"+i(n),"i")).test(e.name);var n},suggestionsTransform:null,autoresize:!0,classNames:{root:"react-tags",rootFocused:"is-focused",selected:"react-tags__selected",selectedTag:"react-tags__selected-tag",selectedTagName:"react-tags__selected-tag-name",search:"react-tags__search",searchWrapper:"react-tags__search-wrapper",searchInput:"react-tags__search-input",suggestions:"react-tags__suggestions",suggestionActive:"is-active",suggestionDisabled:"is-disabled"},delimiters:[p,c],minQueryLength:2,maxSuggestionsLength:6,allowNew:!1,allowBackspace:!0,addOnBlur:!1,tagComponent:null,suggestionComponent:null,inputAttributes:{}},w.propTypes={id:t.string,tags:t.arrayOf(t.object),placeholderText:t.string,ariaLabelText:t.string,removeButtonText:t.string,noSuggestionsText:t.string,suggestions:t.arrayOf(t.object),suggestionsFilter:t.func,suggestionsTransform:t.func,autoresize:t.bool,delimiters:t.arrayOf(t.string),onDelete:t.func.isRequired,onAddition:t.func.isRequired,onInput:t.func,onFocus:t.func,onBlur:t.func,onValidate:t.func,minQueryLength:t.number,maxSuggestionsLength:t.number,classNames:t.object,allowNew:t.bool,allowBackspace:t.bool,addOnBlur:t.bool,tagComponent:t.oneOfType([t.func,t.element]),suggestionComponent:t.oneOfType([t.func,t.element]),inputAttributes:t.object},w}(n(1),n(59))},690:function(e,t,n){"use strict";n.r(t);var a=n(14),r=n.n(a),s=n(386),i=n(30),o=n(635),l=n(1),u=n.n(l),c=n(634),p=n(636),d=function(e){var t=e.appList,n=e.userData,a=u.a.useState(!1),r=Object(o.a)(a,2),s=r[0],i=r[1];return u.a.createElement(c.u,{xl:6},u.a.createElement(c.j,null,u.a.createElement(c.n,null,u.a.createElement(p.a,{name:"cil-user"})," ",n.login," (",n.email_address,")",u.a.createElement("div",{className:"card-header-actions"},1!==n.id&&u.a.createElement(c.db,{className:"card-header-action",onClick:function(){return e.onEditClick(n)}},u.a.createElement(p.a,{name:"cil-pencil"})),u.a.createElement(c.db,{className:"card-header-action",onClick:function(){return i(!s)}},u.a.createElement(p.a,{name:s?"cil-chevron-top":"cil-chevron-bottom"})))),u.a.createElement(c.v,{show:s},u.a.createElement(c.k,null,u.a.createElement("h5",null,"Roles"),!!n.description&&u.a.createElement("p",{class:"lead"},u.a.createElement("em",null,n.description)),t.map((function(e){var t=n.roles.filter((function(t){return t.appId===e.id}));return t.length>0?u.a.createElement(c.j,{key:e.id},u.a.createElement(c.n,null,e.name),u.a.createElement(c.k,null,t.map((function(e){return u.a.createElement(c.b,{key:e.id,className:"font-lg p-2 cna-role text-white mr-1",shape:"pill"},e.name)})))):u.a.createElement(u.a.Fragment,null)}))))))},m=n(687),h=n.n(m);function f(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(e[n].id!==t[n].id)return!1;return!0}var g=n(162),v=n(163);t.default=function(){var e=Object(l.useContext)(g.a),t=Object(l.useState)({data:[]}),n=Object(o.a)(t,2),a=n[0],m=n[1],b=Object(l.useState)({data:[]}),y=Object(o.a)(b,2),E=y[0],x=y[1],w=Object(l.useState)([]),k=Object(o.a)(w,2),T=k[0],O=k[1],N=u.a.useState({id:-1}),S=Object(o.a)(N,2),j=S[0],C=S[1],_=u.a.useState(0),I=Object(o.a)(_,2),D=I[0],R=I[1],q=u.a.useState({}),B=Object(o.a)(q,2),A=B[0],F=B[1],L=Object(l.useRef)(""),W=Object(l.useRef)(""),z=Object(l.useRef)(""),M=Object(l.useRef)(""),U=u.a.useState([]),K=Object(o.a)(U,2),V=K[0],H=K[1];Object(l.useEffect)((function(){var t=!1;function n(){return(n=Object(i.a)(r.a.mark((function n(){var a,i,o,l,u,c,p,d,h,f,g,b,y,E,w,k,T,N,S,j;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,v.a.getApps(e.session);case 5:a=n.sent,n.next=11;break;case 8:n.prev=8,n.t0=n.catch(2),console.log(n.t0);case 11:if(i={},a&&200===a.status){o=a.body,l=[],u=Object(s.a)(o.data);try{for(u.s();!(c=u.n()).done;){p=c.value,i[p.id]=p,d=Object(s.a)(p.availableRoles);try{for(d.s();!(h=d.n()).done;)f=h.value,l.push({id:f.id,appId:f.appId,name:p.name+" - "+f.name})}catch(r){d.e(r)}finally{d.f()}}}catch(r){u.e(r)}finally{u.f()}O(l),x(o),F(i)}return n.prev=13,n.next=16,v.a.getUsers(e.session);case 16:g=n.sent,n.next=22;break;case 19:n.prev=19,n.t1=n.catch(13),console.log(n.t1);case 22:if(g&&200===g.status){b=g.body,y=Object(s.a)(b.data);try{for(y.s();!(E=y.n()).done;){w=E.value,k=[],T=Object(s.a)(w.roles);try{for(T.s();!(N=T.n()).done;)S=N.value,j=i[S.appId],-1===k.indexOf(j)&&k.push(j)}catch(r){T.e(r)}finally{T.f()}k.sort((function(e,t){return e.name>t.name?1:-1})),w.appList=k}}catch(r){y.e(r)}finally{y.f()}m(b)}case 23:case"end":return n.stop()}}),n,null,[[2,8],[13,19]])})))).apply(this,arguments)}return function(){n.apply(this,arguments)}(),function(){t=!0}}),[e.session]);var Q=function(){R(0),C({id:-1})},P=function(){var t=Object(i.a)(r.a.mark((function t(n){var s,i,o,l,u,c,p;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),-1!==j.id){t.next=3;break}return t.abrupt("return");case 3:if(L.current.value!==j.login||W.current.value!==j.name||z.current.value!==j.email_address||""!==M.current.value||!f(V,j.roles)){t.next=6;break}return Q(),t.abrupt("return");case 6:if(t.prev=6,0!==j.id){t.next=18;break}return s={login:L.current.value,name:W.current.value,email_address:z.current.value,password:M.current.value,roles:V},t.next=11,v.a.createUser(s,e.session);case 11:i=t.sent,o=i.body,a.data.push(o),a.data.sort((function(e,t){return e.login>t.login?1:-1})),m(a),t.next=31;break;case 18:return l={},L.current.value!==j.login&&(l.login=L.current.value),W.current.value!==j.name&&(l.name=W.current.value),z.current.value!==j.email_address&&(l.email_address=z.current.value),""!==M.current.value&&(l.password=M.current.value),f(V,j.roles)||(l.roles=V),t.next=26,v.a.patchUser(j.id,l,e.session);case 26:u=t.sent,c=u.body,console.log(c),-1!==(p=a.data.findIndex((function(e){return e.id===c.id})))&&(a.data[p]=c,m(a));case 31:Q(),t.next=37;break;case 34:t.prev=34,t.t0=t.catch(6),console.log(t.t0);case 37:case"end":return t.stop()}}),t,null,[[6,34]])})));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=Object(i.a)(r.a.mark((function t(n){var s;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!(j.id<0)){t.next=3;break}return t.abrupt("return");case 3:if(!(D>0)){t.next=18;break}return t.prev=4,t.next=7,v.a.deleteUser(D,e.session);case 7:return 204===t.sent.status&&-1!==(s=a.data.findIndex((function(e){return e.id===D})))&&(a.data.splice(s,1),m(a)),Q(),R(0),t.abrupt("return");case 14:return t.prev=14,t.t0=t.catch(4),console.log(t.t0),t.abrupt("return");case 18:R(j.id);case 19:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}();return u.a.createElement(u.a.Fragment,null,u.a.createElement(c.wb,null,u.a.createElement(c.u,null,u.a.createElement(c.j,null,u.a.createElement(c.k,null,"User data: ",u.a.createElement("pre",null,JSON.stringify(e.session.payload,null,2)))))),u.a.createElement(c.wb,null," ",a.data.map((function(e){return u.a.createElement(d,{key:e.id,userData:e,appList:E.data,roleSuggestions:T,onEditClick:function(e){L.current.value=e.login,W.current.value=e.name,z.current.value=e.email_address,M.current.value="",H(e.roles.slice()||[]),C(e)}})}))),u.a.createElement(c.wb,null,u.a.createElement(c.u,{className:"mb-3 mb-xl-0"},u.a.createElement(c.f,{shape:"pill",color:"primary",className:"float-right",onClick:function(){L.current.value="",W.current.value="",z.current.value="",M.current.value="",H([]),C({id:0,login:"",name:"",email_address:"",password:"",roles:[]})}},u.a.createElement(p.a,{name:"cil-user-plus"})," Add user"))),u.a.createElement(c.gb,{show:j.id>=0,onClose:Q,color:D>0?"danger":"default",size:"lg"},u.a.createElement(c.J,{onSubmit:P},u.a.createElement(c.jb,{closeButton:!0},u.a.createElement(c.kb,null,0===D?0===j.id?"Create new user":"Edit details of":"Delete user"," ",j.login)),u.a.createElement(c.hb,null,u.a.createElement("fieldset",{disabled:D>0?"disabled":""},u.a.createElement(c.K,null,u.a.createElement(c.V,null,u.a.createElement(c.S,{innerRef:L,id:"login",name:"login",placeholder:"Login",autoComplete:"login"}),u.a.createElement(c.W,null,u.a.createElement(c.Y,null,u.a.createElement(p.a,{name:"cil-at"}))))),u.a.createElement(c.K,null,u.a.createElement(c.V,null,u.a.createElement(c.S,{innerRef:W,id:"name",name:"name",placeholder:"Name",autoComplete:"name"}),u.a.createElement(c.W,null,u.a.createElement(c.Y,null,u.a.createElement(p.a,{name:"cil-user"}))))),u.a.createElement(c.K,null,u.a.createElement(c.V,null,u.a.createElement(c.S,{innerRef:z,type:"email",id:"email",name:"email",placeholder:"Email",autoComplete:"email"}),u.a.createElement(c.W,null,u.a.createElement(c.Y,null,u.a.createElement(p.a,{name:"cil-envelope-closed"}))))),u.a.createElement(c.K,null,u.a.createElement(c.V,null,u.a.createElement(c.S,{innerRef:M,type:"password",id:"password",name:"password",placeholder:"Password"}),u.a.createElement(c.W,null,u.a.createElement(c.Y,null,u.a.createElement(p.a,{name:"cil-asterisk"}))))),u.a.createElement(c.j,null,u.a.createElement(c.n,null,"Roles"),u.a.createElement(c.k,null,u.a.createElement("div",{style:{width:"100%"}},u.a.createElement(h.a,{foo:"bar",removeButtonText:"Click to remove role",tagComponent:function(e){return u.a.createElement("button",{type:"button",className:e.classNames.selectedTag,title:e.removeButtonText,onClick:e.onDelete},u.a.createElement("span",{className:e.classNames.selectedTagName},((A[e.tag.appId]||{}).name||"")+" - "+e.tag.name))},onAddition:function(e){if(-1===V.findIndex((function(t){return t.id===e.id}))){var t=A[e.appId];if(t.availableRoles&&t.availableRoles.length){var n=t.availableRoles.find((function(t){return t.id===e.id}));n&&V.push(n)}V.sort((function(e,t){return e.name>t.name?1:-1})),H(V)}},onDelete:function(e){V.splice(e,1),H(V)},placeholderText:"Add new role",allowBackspace:!1,tags:V,suggestions:T})))))),u.a.createElement(c.ib,null,j.id>0&&u.a.createElement(u.a.Fragment,null,u.a.createElement(c.f,{color:"danger",onClick:J},D>0?"FINISH IT":"Delete"),u.a.createElement("div",{className:"flex-fill"})),u.a.createElement(c.f,{color:"secondary",onClick:Q},"Cancel")," ",0===D&&u.a.createElement(c.f,{type:"submit",color:"primary"},"Save")))))}}}]);
//# sourceMappingURL=6.b8e8d059.chunk.js.map